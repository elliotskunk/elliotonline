<!DOCTYPE html>
<html>
<head>
    <title>eBay Inventory Manager</title>
    <style>
        .entry {
            border: 1px solid #ddd;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        
        .success {
            background-color: #f0fff0;
            border-color: #d0f0d0;
        }
        
        .error {
            background-color: #fff0f0;
            border-color: #f0d0d0;
        }
        
        .entry-details table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        
        .entry-details th,
        .entry-details td {
            padding: 8px;
            border: 1px solid #ddd;
            text-align: left;
        }
        
        .entry-details th {
            background-color: #f5f5f5;
        }
        
        .validation-errors {
            margin-top: 15px;
            padding: 10px;
            background-color: #fff8e1;
            border: 1px solid #ffe082;
            border-radius: 4px;
        }
        
        .success-message {
            color: #2e7d32;
            font-weight: bold;
        }
        
        .error-message {
            color: #c62828;
            font-weight: bold;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 15px 0;
        }
        
        #updateForm input[type="text"],
        #updateForm input[type="number"] {
            width: 100%;
            padding: 8px;
            margin: 5px 0;
        }

        .update-result {
            padding: 10px;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        .update-result.success {
            background: #e8f5e9;
            color: #2e7d32;
            border: 1px solid #a5d6a7;
        }
        
        .update-result.error {
            background: #ffebee;
            color: #c62828;
            border: 1px solid #ef9a9a;
        }
    </style>
</head>
<body>
    <h1>Add New Item</h1>
    <form method="POST">
        <textarea name="input_text" rows="4" cols="50" placeholder="Enter item details..."></textarea><br><br>
        <input type="submit" value="Submit">
    </form>

    <h2>Update Existing Entry</h2>
    <form method="POST" id="updateForm">
        <input type="text" name="update_id" placeholder="Entry ID" required>
        <div class="form-grid">
            <div>
                <label>Catalogue Number:</label>
                <input type="text" name="catalogue_number">
            </div>
            <div>
                <label>Storage Location:</label>
                <input type="text" name="storage_location">
            </div>
            <div>
                <label>Box Label:</label>
                <input type="text" name="box_label">
            </div>
            <div>
                <label>Place Bought:</label>
                <input type="text" name="place_bought">
            </div>
            <div>
                <label>Restock Quantity:</label>
                <input type="number" name="restock_qty" min="0">
            </div>
            <div>
                <label>Quantity Sold:</label>
                <input type="number" name="quantity_sold" min="0">
            </div>
        </div>
        <input type="submit" value="Update Entry">
    </form>

    {% if update_result %}
    <div class="update-result {% if '✅' in update_result %}success{% else %}error{% endif %}">
        {{ update_result }}
    </div>
    {% endif %}

    <h2>Processed Entries:</h2>
    {% if entries %}
    <div class="results">
        {% for entry in entries %}
            <div class="entry {% if entry.status == 'success' %}success{% elif entry.status == 'error' %}error{% endif %}">
                <h3>
                    {% if entry.item %}{{ entry.item }}{% else %}Unparsed Entry{% endif %}
                    <small style="font-size: 0.8em; color: #666">ID: {{ entry.id }}</small>
                </h3>
                
                <div class="entry-details">
                    <table>
                        <tr>
                            <th>Field</th>
                            <th>Value</th>
                        </tr>
                        <tr>
                            <td>Price</td>
                            <td>£{{ "%.2f"|format(entry.price) }}</td>
                        </tr>
                        <tr>
                            <td>Storage Location</td>
                            <td>{{ entry.storage_location }}</td>
                        </tr>
                        <tr>
                            <td>Box Label</td>
                            <td>{{ entry.box_label }}</td>
                        </tr>
                        <tr>
                            <td>Date</td>
                            <td>{{ entry.date }}</td>
                        </tr>
                        <tr>
                            <td>Total Quantity</td>
                            <td>{{ entry.total_qty }}</td>
                        </tr>
                        <tr>
                            <td>Remaining Quantity</td>
                            <td>{{ entry.remaining_qty }}</td>
                        </tr>
                    </table>
                    
                    {% if entry.errors %}
                        <div class="validation-errors">
                            <strong>Validation Issues:</strong>
                            <ul>
                                {% for error in entry.errors %}
                                    <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                    {% endif %}
                </div>
            </div>
        {% endfor %}
    </div>
    {% else %}
        <p>No entries processed yet.</p>
    {% endif %}
</body>
</html>
